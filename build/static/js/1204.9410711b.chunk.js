"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[1204],{61204:(e,t,r)=>{r.r(t),r.d(t,{default:()=>v});var i=r(72791),c=r(30018),s=r(89743),n=r(2677),a=r(29795),d=r(62591),l=r(8116),o=r(17612),h=r(43360),j=r(55294),x=r(9806),u=r(11632),p=r(583),m=r(80184);const k="http://api1.chandrakala.co.in",v=()=>{const[e,t]=(0,i.useState)([]),[r,v]=(0,i.useState)(!1),[Z,g]=(0,i.useState)(null),[y,w]=(0,i.useState)(!1),[C,f]=(0,i.useState)(!0),[S,I]=(0,i.useState)(null),[T,_]=(0,i.useState)(!1),[b,N]=(0,i.useState)(!1),{user:A}=(0,p.a)(),[D,L]=(0,i.useState)(1),[B]=(0,i.useState)(10),[H,E]=(0,i.useState)(""),F=e.filter((e=>{const t=H.toLowerCase();return e.title&&e.title.toLowerCase().includes(t)||e.status&&e.status.toLowerCase().includes(t)||e.priority&&e.priority.toLowerCase().includes(t)||e.ticketType&&e.ticketType.toLowerCase().includes(t)||e.department&&e.department.toLowerCase().includes(t)||e.project&&e.project.toLowerCase().includes(t)})),z=async()=>{try{const e=await j.Z.get("".concat("http://api1.chandrakala.co.in/api/Tickets/ArchivedByUser","?userId=").concat(A.userId),{headers:{Authorization:"Bearer ".concat(null===A||void 0===A?void 0:A.token)}});t(e.data),f(!1)}catch(S){console.error("Error fetching archived tickets:",S),f(!1)}},M=Math.ceil(F.length/B),P=F.slice((D-1)*B,D*B),U=e=>{L(e)};(0,i.useEffect)((()=>{z()}),[null===A||void 0===A?void 0:A.userId]);const G=()=>{g(null),w(!1)};return(0,m.jsxs)("div",{className:"mt-6 table-responsive",children:[S&&(0,m.jsx)(c.Z,{variant:"danger",children:S}),(0,m.jsxs)(s.Z,{children:[(0,m.jsx)(n.Z,{md:10}),(0,m.jsxs)(n.Z,{md:2,children:[" ",(0,m.jsx)(a.Z.Control,{type:"text",placeholder:"Search...",value:H,onChange:e=>{E(e.target.value),L(1)},className:"mb-3 text-start"})]})]}),C?(0,m.jsx)("div",{children:"Loading..."}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(d.Z,{striped:!0,bordered:!0,hover:!0,children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{children:"S.No"}),(0,m.jsx)("th",{children:"TicketID"}),(0,m.jsx)("th",{children:"Title"}),(0,m.jsx)("th",{children:"Status"}),(0,m.jsx)("th",{children:"Priority"}),(0,m.jsx)("th",{children:"TicketType"}),(0,m.jsx)("th",{children:"DueDate"}),(0,m.jsx)("th",{children:"Department"}),(0,m.jsx)("th",{children:"ProjectType"}),(0,m.jsx)("th",{children:"Action"})]})}),(0,m.jsx)("tbody",{children:P.map(((e,t)=>(0,m.jsxs)("tr",{children:[(0,m.jsx)("td",{children:t+1}),(0,m.jsx)("td",{children:e.ticketId}),(0,m.jsx)("td",{children:e.title}),(0,m.jsx)("td",{children:e.status}),(0,m.jsx)("td",{children:e.priority}),(0,m.jsx)("td",{children:e.ticketType}),(0,m.jsx)("td",{children:new Date(e.dueDate).toLocaleString()}),(0,m.jsx)("td",{children:e.department}),(0,m.jsx)("td",{children:e.project}),(0,m.jsx)("td",{children:(0,m.jsxs)("div",{className:"d-flex align-items-center",children:[(0,m.jsx)("div",{className:"me-3",children:(0,m.jsx)(x.G,{icon:u.Mdf,className:"text-success",onClick:()=>(e=>{g(e),v(!0)})(e)})}),(0,m.jsx)("div",{children:(0,m.jsx)(x.G,{icon:u.jHE,className:"text-danger",onClick:()=>(e=>{g(e),w(!0)})(e)})})]})})]},e.ticketId)))})]}),(0,m.jsx)(s.Z,{className:"justify-content-end",children:(0,m.jsx)(n.Z,{md:"auto",children:(0,m.jsxs)(l.Z,{children:[(0,m.jsx)(l.Z.Prev,{onClick:()=>D>1&&U(D-1),disabled:1===D}),[...Array(M)].map(((e,t)=>(0,m.jsx)(l.Z.Item,{active:t+1===D,onClick:()=>U(t+1),children:t+1},t))),(0,m.jsx)(l.Z.Next,{onClick:()=>D<M&&U(D+1),disabled:D===M})]})})})]}),(0,m.jsxs)(o.Z,{show:y,onHide:G,children:[(0,m.jsx)(o.Z.Header,{closeButton:!0,children:(0,m.jsx)(o.Z.Title,{children:"Confirm Unarchive"})}),(0,m.jsxs)(o.Z.Body,{children:["Are you sure you want to unarchive ticket ",Z?Z.ticketId:"","?"]}),(0,m.jsxs)(o.Z.Footer,{children:[(0,m.jsx)(h.Z,{variant:"secondary",onClick:G,children:"Cancel"}),(0,m.jsx)(h.Z,{variant:"danger",onClick:async()=>{if(Z&&null!==A&&void 0!==A&&A.token&&null!==A&&void 0!==A&&A.userId)try{await j.Z.post("".concat("http://api1.chandrakala.co.in/api/Tickets","/").concat(Z.ticketId,"/unarchive?userId=").concat(A.userId),{},{headers:{Authorization:"Bearer ".concat(A.token)}}),window.location.reload(),z()}catch(S){console.error("Error unarchiving ticket:",S.response?S.response.data:S.message),I("Failed to unarchive the ticket.")}finally{G()}else console.error("Missing required information for unarchiving ticket.")},children:"Unarchive"})]})]}),Z&&(0,m.jsxs)(o.Z,{show:r,onHide:()=>v(!1),size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[(0,m.jsx)(o.Z.Header,{closeButton:!0,children:(0,m.jsx)(o.Z.Title,{id:"contained-modal-title-vcenter",children:"Ticket Details"})}),(0,m.jsxs)(o.Z.Body,{children:[(0,m.jsxs)("p",{children:["Title: ",Z.title]}),(0,m.jsxs)("p",{children:["Description: ",Z.description]}),(0,m.jsxs)("p",{children:["Creator ID: ",Z.creatorName]}),(0,m.jsxs)("p",{children:["Assignee ID: ",Z.assigneeName]}),(0,m.jsx)("p",{children:"Attachments:"}),Z.attachment&&(0,m.jsx)("div",{children:b&&/\.(png|jpg|jpeg|gif|bmp)$/i.test(Z.attachment)?(0,m.jsx)("img",{src:"".concat(k,"/").concat(Z.attachment.replace("wwwroot/","")),alt:"Attachment",className:"img-fluid"}):(0,m.jsx)("p",{children:(0,m.jsx)("a",{href:"".concat(k,"/").concat(Z.attachment.replace("wwwroot/","")),target:"_blank",rel:"noopener noreferrer",children:"View Attachment"})})})]}),(0,m.jsx)(o.Z.Footer,{children:(0,m.jsx)(h.Z,{onClick:()=>v(!1),children:"Close"})})]})]})}}}]);
//# sourceMappingURL=1204.9410711b.chunk.js.map