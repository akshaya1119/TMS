(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[5769,276],{24220:(e,a,n)=>{"use strict";n.d(a,{R:()=>d});var t=n(72791),i=n(89704),c=n.n(i);const s={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_ARCHIEVED:"http://api1.chandrakala.co.in/api/Tickets/ArchivedByUser",REACT_APP_API_CHANGE_PASSWORD:"http://api1.chandrakala.co.in/api/Login/ChangePassword",REACT_APP_API_DEPARTMENTS:"http://api1.chandrakala.co.in/api/Departments",REACT_APP_API_DESIGNATION:"http://api1.chandrakala.co.in/api/Designation",REACT_APP_API_Filter:"http://api1.chandrakala.co.in/api/Tickets/filter",REACT_APP_API_FORGOT_PASSWORD:"http://api1.chandrakala.co.in/api/Login/ForgetPassword",REACT_APP_API_LOGIN:"http://api1.chandrakala.co.in/api/Login",REACT_APP_API_MODULE:"http://api1.chandrakala.co.in/api/Modules",REACT_APP_API_PERMISSION:"http://api1.chandrakala.co.in/api/Permission",REACT_APP_API_PROJECTTYPE:"http://api1.chandrakala.co.in/api/ProjectType",REACT_APP_API_SavedSearch:"http://api1.chandrakala.co.in/api/SearchSave",REACT_APP_API_TICKET:"http://api1.chandrakala.co.in/api/Tickets",REACT_APP_API_TICKETFLOW:"http://api1.chandrakala.co.in/api/TicketFlow",REACT_APP_API_TICKETFLOW_BY_COMMENTS:"http://api1.chandrakala.co.in/api/TicketFlow/CommentsByTicketId",REACT_APP_API_TICKETTYPE:"http://api1.chandrakala.co.in/api/TicketTypes",REACT_APP_API_TICKET_COMPLETED:"http://api1.chandrakala.co.in/api/Tickets/MarkCompleted",REACT_APP_API_UPLOAD:"http://api1.chandrakala.co.in/api/Users/upload",REACT_APP_API_USERS:"http://api1.chandrakala.co.in/api/Users",REACT_APP_API_USER_BY_ID:"http://api1.chandrakala.co.in/api/Users",REACT_APP_BASE_API_URL:"http://api1.chandrakala.co.in/api",REACT_APP_BASE_URL:"http://api1.chandrakala.co.in",REACT_APP_MY_SERVER:"http://ticket.chandrakala.co.in"}.REACT_APP_SECRET_KEY||"ghjsfysdg123",r=(0,t.createContext)({encrypt:e=>c().AES.encrypt(e.toString(),s).toString().replace(/\//g,";"),decrypt:e=>{if("string"!==typeof e)return e;e=e.replace(/;/g,"/");return c().AES.decrypt(e,s).toString(c().enc.Utf8)}}),d=()=>(0,t.useContext)(r)},8011:(e,a,n)=>{"use strict";n.r(a),n.d(a,{default:()=>A});var t=n(72791),i=n(2515),c=n(55294),s=n(47022),r=n(89743),d=n(2677),l=n(54694),o=n(43360),h=n(42922),p=n(583),_=n(80184);const A=()=>{const[e,a]=(0,t.useState)([]),{user:n}=(0,p.a)(),[A,P]=(0,t.useState)(null),[u,y]=(0,t.useState)(""),[E,m]=(0,t.useState)(!1);(0,t.useEffect)((()=>{(async()=>{try{const e=await c.Z.get("".concat("http://api1.chandrakala.co.in","/api/Users"),{headers:{Authorization:"Bearer ".concat(null===n||void 0===n?void 0:n.token)}});a(e.data)}catch(e){console.error("Error fetching users:",e)}})()}),[]);return(0,_.jsx)(s.Z,{className:"py-4",children:(0,_.jsxs)(r.Z,{children:[(0,_.jsx)(d.Z,{md:4,children:(0,_.jsx)(l.Z,{children:(0,_.jsxs)(l.Z.Body,{children:[(0,_.jsx)("h5",{className:"mb-4",children:"Select User to View Permissions"}),(0,_.jsx)(i.ZP,{options:e.map((e=>({value:e.userId.toString(),label:"".concat(e.firstName," ").concat(e.lastName),departmentname:e.departmentname}))),filterOption:(e,a)=>{let{label:n}=e;return n.toLowerCase().includes(a.toLowerCase())},placeholder:"Search for a user...",onChange:e=>{P(e),y(e.departmentname),m(!1)},value:A}),A&&(0,_.jsxs)("div",{className:"mt-4 ",children:[(0,_.jsxs)("h6",{children:["Department Name: ",u]}),(0,_.jsx)("div",{className:"text-center",children:(0,_.jsx)(o.Z,{onClick:()=>{m(!0)},children:"View Permission"})})]})]})})}),(0,_.jsx)(d.Z,{md:6,children:E&&A&&(0,_.jsx)(h.default,{userId:null===A||void 0===A?void 0:A.value})})]})})}},42922:(e,a,n)=>{"use strict";n.r(a),n.d(a,{default:()=>m});var t=n(72791),i=n(47022),c=n(30018),s=n(89743),r=n(2677),d=n(54694),l=n(29795),o=n(62591),h=n(43360),p=(n(77632),n(55294)),_=n(24220),A=n(36704),P=n(57689),u=n(583),y=n(80184);const E="http://api1.chandrakala.co.in",m=e=>{let{userId:a}=e;const{user:n}=(0,u.a)(),{encrypt:m}=(0,_.R)(),[C,T]=(0,t.useState)([]),[k,O]=(0,t.useState)([]),[x,j]=(0,t.useState)(!1),[I,S]=(0,t.useState)(""),[R,g]=(0,t.useState)(""),[w,f]=(0,t.useState)(null),v=(0,P.s0)();(0,t.useEffect)((()=>{(async()=>{try{const e=await p.Z.get("".concat(E,"/api/Permission/ByUser/").concat(a),{headers:{Authorization:"Bearer ".concat(null===n||void 0===n?void 0:n.token)}});e.data&&0===e.data.length?g("No permissions have been assigned to this user. Thank You"):(T(e.data),g(""))}catch(e){console.error("Error fetching permissions:",e),g("Error fetching permissions.")}})(),(async()=>{try{const e=await p.Z.get("".concat(E,"/api/Modules"),{headers:{Authorization:"Bearer ".concat(null===n||void 0===n?void 0:n.token)}});O(e.data)}catch(e){console.error("Error fetching modules:",e),g("Error fetching modules. Please try again.")}})()}),[a]);const U=async(e,a,t)=>{j(!0),g("");try{const i=C.map((n=>n.permission_Id===e?"canViewOnly"!==a||t?{...n,[a]:t,..."canViewOnly"===a&&t?{canAddOnly:!1,canUpdateOnly:!1,canDeleteOnly:!1}:"canAddOnly"===a&&t?{canViewOnly:!0}:"canUpdateOnly"===a&&t?{canViewOnly:!0,canAddOnly:!0}:"canDeleteOnly"===a&&t?{canViewOnly:!0,canAddOnly:!0,canUpdateOnly:!0}:{}}:{...n,canViewOnly:!1,canAddOnly:!1,canUpdateOnly:!1,canDeleteOnly:!1}:n));T(i),f(e);const c=i.find((a=>a.permission_Id===e));if(!c)return void g("Updated permission not found. Please try again.");const{permission_Id:s,userID:r,id:d,canAddOnly:l,canDeleteOnly:o,canUpdateOnly:h,canViewOnly:_}=c;await p.Z.put("".concat(E,"/api/Permission/").concat(s),{permission_Id:s,userID:r,id:d,canAddOnly:l,canDeleteOnly:o,canUpdateOnly:h,canViewOnly:_},{headers:{Authorization:"Bearer ".concat(null===n||void 0===n?void 0:n.token)}}),S("Permissions updated successfully")}catch(i){console.error("Error updating permissions:",i),g("Error updating permissions. Please try again.")}finally{j(!1)}},Z=()=>{v("/Users/AddPermissions/".concat(m(a)))},D=e=>{const a=k.find((a=>a.id===e));return a?a.name:"Unknown"};return(0,y.jsx)(A.Z,{children:e=>{let{hasPermission:a}=e;return a(7,"canUpdateOnly")&&(0,y.jsxs)(i.Z,{children:[I&&!x&&(0,y.jsx)(c.Z,{variant:"success",className:"mt-3",children:I}),R&&!x&&(0,y.jsx)(c.Z,{variant:"danger",className:"mt-3",children:R}),(0,y.jsx)(s.Z,{className:"justify-content-center",children:(0,y.jsx)(r.Z,{md:12,children:(0,y.jsxs)(d.Z,{children:[(0,y.jsx)(d.Z.Header,{as:"h5",className:"text-center",children:"Update Permissions"}),(0,y.jsx)(d.Z.Body,{children:(0,y.jsx)(l.Z,{className:"table-responsive",children:(0,y.jsxs)(o.Z,{bordered:!0,children:[(0,y.jsx)("thead",{children:(0,y.jsxs)("tr",{children:[(0,y.jsx)("th",{children:"Module Name"}),(0,y.jsx)("th",{children:"Can View"}),(0,y.jsx)("th",{children:"Can Add"}),(0,y.jsx)("th",{children:"Can Update"}),(0,y.jsx)("th",{children:"Can Delete"})]})}),(0,y.jsx)("tbody",{children:C.length>0?C.map((e=>(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{children:D(e.id)}),(0,y.jsx)("td",{children:(0,y.jsx)(l.Z.Check,{type:"switch",id:"".concat(D(e.id),"-canview-switch"),label:"",checked:e.canViewOnly,onChange:a=>U(e.permission_Id,"canViewOnly",a.target.checked)})}),(0,y.jsx)("td",{children:(0,y.jsx)(l.Z.Check,{type:"switch",id:"".concat(D(e.id),"-canadd-switch"),label:"",checked:e.canAddOnly,onChange:a=>U(e.permission_Id,"canAddOnly",a.target.checked)})}),(0,y.jsx)("td",{children:(0,y.jsx)(l.Z.Check,{type:"switch",id:"".concat(D(e.id),"-canupdate-switch"),label:"",checked:e.canUpdateOnly,onChange:a=>U(e.permission_Id,"canUpdateOnly",a.target.checked)})}),(0,y.jsx)("td",{children:(0,y.jsx)(l.Z.Check,{type:"switch",id:"".concat(D(e.id),"-candelete-switch"),label:"",checked:e.canDeleteOnly,onChange:a=>U(e.permission_Id,"canDeleteOnly",a.target.checked)})})]},e.permission_Id))):(0,y.jsx)("tr",{children:(0,y.jsxs)("td",{colSpan:"5",className:"text-center",children:[R,(0,y.jsx)(h.Z,{variant:"primary",onClick:Z,children:"Assign Permissions"})]})})})]})})})]})})})]})}})}},42480:()=>{}}]);
//# sourceMappingURL=5769.25d7cee0.chunk.js.map