"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[618],{75489:(e,t,a)=>{a.r(t),a.d(t,{default:()=>h});var s=a(55294),i=a(72791),n=a(583),o=a(24849),l=a(57689),c=a(2515),r=a(22120),d=a.n(r);const m=a.p+"static/media/greentick.ef2ae37034b7e6bd95f0.jpg";var u=a(80184);const h=()=>{const e=(0,l.s0)(),{user:t}=(0,n.a)(),[a,r]=(0,i.useState)(!1),[h,p]=(0,i.useState)([]),[f,v]=(0,i.useState)([]),[b,g]=(0,i.useState)([]),[j,N]=(0,i.useState)({creatorName:t.firstName,priority:"low",title:"",departmentId:"",ticketTypeId:"",status:"Open",projectId:"",dueDate:"",description:"",assigneeId:"",attachments:null}),[x,y]=(0,i.useState)(null),[k,I]=(0,i.useState)("");(0,i.useEffect)((()=>{const e=(new Date).toISOString().split("T")[0];I(e)}),[]),(0,i.useEffect)((()=>{!async function(){try{const e=await s.Z.get("http://api1.chandrakala.co.in/api/Users",{headers:{Authorization:"Bearer ".concat(null===t||void 0===t?void 0:t.token)}});g(e.data)}catch(e){console.error("Error fetching Assignee:",e)}}()}),[]),(0,i.useEffect)((()=>{!async function(){try{const e=await s.Z.get("http://api1.chandrakala.co.in/api/TicketTypes",{headers:{Authorization:"Bearer ".concat(null===t||void 0===t?void 0:t.token)}});p(e.data)}catch(e){console.error("Error fetching Ticket Type:",e)}}()}),[]),(0,i.useEffect)((()=>{}),[h]),(0,i.useEffect)((()=>{!async function(){try{const e=await s.Z.get("http://api1.chandrakala.co.in/api/ProjectType",{headers:{Authorization:"Bearer ".concat(null===t||void 0===t?void 0:t.token)}});v(e.data)}catch(e){console.error("Error fetching Project Type:",e)}}()}),[]);const T=e=>{const{name:a,value:s}=e.target||e;if("assigneeId"===a){const e=b.find((e=>e.userId===s)),i=s===t.userId,n=i?e.departmentname:(null===e||void 0===e?void 0:e.departmentname)||"";N((t=>({...t,[a]:s,departmentId:(null===e||void 0===e?void 0:e.departmentId)||"",department:n,status:i?"Self-Assigned":"Open"})))}else N("departmentId"===a?e=>({...e,departmentId:s}):e=>({...e,[a]:s}))};(0,i.useEffect)((()=>{const e=b.find((e=>e.userId===j.assigneeId)),a=j.assigneeId===t.userId,s=a?null===e||void 0===e?void 0:e.departmentname:(null===e||void 0===e?void 0:e.departmentname)||"";N((t=>({...t,departmentId:(null===e||void 0===e?void 0:e.departmentId)||"",department:s,status:a?"Self-Assigned":"Open"})))}),[j.assigneeId,b,t]);return(0,u.jsxs)("div",{className:"container mt-5",children:[(0,u.jsx)("div",{className:"d-flex justify-content-between"}),x&&(0,u.jsx)("div",{className:"alert ".concat(x.includes("successfully")?"alert-success":"alert-danger"),role:"alert",children:x}),(0,u.jsxs)("form",{onSubmit:async a=>{a.preventDefault(),r(!0);const i=Object.entries(j).filter((e=>{let[t,a]=e;return"department"!==t})).map((e=>{let[a,s]=e;return"".concat("creatorName"===a?"creatorId":a,"=").concat("creatorName"===a?t.userId:s)})).join("&"),n=new FormData;Object.entries(j).forEach((e=>{let[t,a]=e;if("attachments"===t){if(a)for(let s=0;s<a.length;s++)n.append("attachments",a[s])}else n.append(t,a)}));try{const a=await s.Z.post("".concat("http://api1.chandrakala.co.in/api/Tickets","?").concat(i),n,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer ".concat(null===t||void 0===t?void 0:t.token)}});y("Ticket added successfully!"),r(!1),d()({title:"Ticket",message:"New ticket has been assigned",duration:11e3,icon:m,native:!0,onClick:()=>window.location="".concat("http://ticket.chandrakala.co.in")}),N({creatorName:t.firstName,priority:"low",title:"",departmentId:"",ticketTypeId:"",status:"Open",projectId:"",dueDate:"",description:"",assigneeId:"",attachments:null}),e("/Tickets/AddTicket/".concat(a.data.userId))}catch(o){console.error(o),y("Error adding ticket. Please try again."),r(!1)}},children:[(0,u.jsxs)("div",{className:"row mb-3",children:[(0,u.jsx)("label",{htmlFor:"creatorName",className:"col-sm-3 col-form-label text-end",children:"Creator"}),(0,u.jsx)("div",{className:"col-sm-3",children:(0,u.jsx)("input",{type:"text",className:"form-control",id:"creatorName",name:"creatorName",placeholder:"Enter your Name",required:!0,value:t.firstName,onChange:T,disabled:!0})}),(0,u.jsxs)("label",{htmlFor:"assigneeId",className:"col-sm-3 col-form-label text-end",children:["Assignee Name",(0,u.jsx)("span",{className:"text-danger",children:" * "})]}),(0,u.jsx)("div",{className:"col-sm-3",children:(0,u.jsx)(c.ZP,{options:b.map((e=>({label:e.fullName,value:e.userId}))),value:j.assigneeId?{label:b.find((e=>e.userId===j.assigneeId)).fullName,value:j.assigneeId}:null,onChange:e=>T({target:{name:"assigneeId",value:e.value}}),isSearchable:!0,placeholder:"Select Assignee"})})]}),(0,u.jsxs)("div",{className:"row mb-3",children:[(0,u.jsxs)("label",{htmlFor:"title",className:"col-sm-3 col-form-label text-end",children:["Title",(0,u.jsx)("span",{className:"text-danger",children:" * "})]}),(0,u.jsx)("div",{className:"col-sm-3",children:(0,u.jsx)("input",{type:"text",className:"form-control",id:"title",name:"title",placeholder:"Enter title",required:!0,onChange:T})}),(0,u.jsxs)("label",{htmlFor:"priority",className:"col-sm-3 col-form-label text-end",children:["Priority",(0,u.jsx)("span",{className:"text-danger",children:" * "})]}),(0,u.jsx)("div",{className:"col-sm-3",children:(0,u.jsxs)("select",{className:"form-select",id:"priority",name:"priority",placeholder:"Select priority",required:!0,onChange:T,children:[(0,u.jsx)("option",{defaultValue:!0,children:"Select Priority"}),(0,u.jsx)("option",{value:"low",children:"Low"}),(0,u.jsx)("option",{value:"medium",children:"Medium"}),(0,u.jsx)("option",{value:"high",children:"High"})]})})]}),(0,u.jsxs)("div",{className:"row mb-3",children:[(0,u.jsxs)("label",{htmlFor:"ticketTypeId",className:"col-sm-3 col-form-label text-end",children:["Ticket Type",(0,u.jsx)("span",{className:"text-danger",children:" * "})]}),(0,u.jsx)("div",{className:"col-sm-3",children:(0,u.jsx)(c.ZP,{options:h.map((e=>({label:e.ticketType,value:e.ticketTypeId}))),value:j.ticketTypeId?{label:h.find((e=>e.ticketTypeId===j.ticketTypeId)).ticketType,value:j.ticketTypeId}:null,onChange:e=>T({target:{name:"ticketTypeId",value:e.value}}),isSearchable:!0,placeholder:"Select Ticket Type"})}),(0,u.jsx)("label",{htmlFor:"status",className:"col-sm-3 col-form-label text-end",children:"Status"}),(0,u.jsx)("div",{className:"col-sm-3",children:(0,u.jsx)("input",{className:"form-control",id:"status",name:"status",value:j.status,required:!0,onChange:T,readOnly:!0,disabled:!0})})]}),(0,u.jsxs)("div",{className:"row mb-3",children:[(0,u.jsxs)("label",{htmlFor:"projectId",className:"col-sm-3 col-form-label text-end",children:["Project Type",(0,u.jsx)("span",{className:"text-danger",children:" * "})]}),(0,u.jsx)("div",{className:"col-sm-3",children:(0,u.jsx)(c.ZP,{options:f.map((e=>({label:e.projectTypes,value:e.projectId}))),value:j.projectId?{label:f.find((e=>e.projectId===j.projectId)).projectTypes,value:j.projectId}:null,onChange:e=>T({target:{name:"projectId",value:e.value}}),isSearchable:!0,placeholder:"Select Project Type",required:!0})}),(0,u.jsxs)("label",{htmlFor:"dueDate",className:"col-sm-3 col-form-label text-end",children:["Due Date",(0,u.jsx)("span",{className:"text-danger",children:" * "})]}),(0,u.jsx)("div",{className:"col-sm-3",children:(0,u.jsx)("input",{type:"date",className:"form-control",id:"dueDate",name:"dueDate",placeholder:"Select Due Date",required:!0,min:k,onChange:T})})]}),(0,u.jsxs)("div",{className:"row mb-3",children:[(0,u.jsx)("label",{htmlFor:"ticketId",className:"col-sm-3 col-form-label text-end",children:"Ticket ID:"}),(0,u.jsx)("div",{className:"col-sm-3",children:(0,u.jsx)("input",{type:"text",className:"form-control",id:"ticketId",name:"ticketId",placeholder:"Ticket ID",required:!0,onChange:T,disabled:!0,value:"0"})}),(0,u.jsx)("label",{htmlFor:"department",className:"col-sm-3 col-form-label text-end",children:"Department"}),(0,u.jsx)("div",{className:"col-sm-3",children:(0,u.jsx)(c.ZP,{value:{value:j.departmentId,label:j.department},components:{DropdownIndicator:()=>null,IndicatorSeparator:()=>null},isDisabled:!0})})]}),(0,u.jsxs)("div",{className:"row mb-3",children:[(0,u.jsxs)("label",{htmlFor:"description",className:"col-sm-3 col-form-label text-end",children:["Description",(0,u.jsx)("span",{className:"text-danger",children:" * "})]}),(0,u.jsx)("div",{className:"col-sm-9",children:(0,u.jsx)("textarea",{className:"form-control",id:"description",name:"description",placeholder:"Enter description",rows:"4",required:!0,onChange:T})})]}),(0,u.jsxs)("div",{className:"row mb-3",children:[(0,u.jsx)("label",{htmlFor:"attachments",className:"col-sm-3 col-form-label text-end",children:"Attachments:"}),(0,u.jsx)("div",{className:"col-sm-9",children:(0,u.jsx)("input",{type:"file",className:"form-control",id:"attachments",name:"attachments",multiple:!0,onChange:e=>{const t=Array.from(e.target.files);N((e=>({...e,attachments:[...e.attachments||[],...t]})))}})})]}),(0,u.jsxs)("div",{className:"row mb-3",children:[(0,u.jsx)("div",{className:"col-sm-3"}),(0,u.jsx)("div",{className:"col-sm-9 text-end",children:(0,u.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:a,children:a?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(o.Z,{animation:"border",size:"sm"})," Adding Ticket..."]}):"Add Ticket"})})]})]})]})}},22120:function(e,t,a){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Notifications=void 0;const i=s(a(5943));t.Notifications=i.default;const n=s(a(52932)).default.addNotification;t.default=n},5943:function(e,t,a){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=s(a(72791)),n=s(a(52932));a(7969);const o=s(a(64788));class l extends i.default.Component{constructor(){super(...arguments),this.state={value:[]}}componentDidMount(){n.default.addListener((e=>this.setState({value:e})))}render(){const{position:e}=this.props,t="rpn-notification-holder ".concat(e||"top-middle"," supertest");return i.default.createElement("div",{className:t},this.state.value.map(((e,t)=>i.default.createElement(o.default,{key:t,closeNotification:n.default.popAndPush,onClick:e.onClick,id:e.id,theme:e.theme,title:e.title,subtitle:e.subtitle,closeButton:e.closeButton,message:e.message,styling:e.styling}))))}}t.default=l},64788:function(e,t,a){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=s(a(72791));t.default=e=>{const{title:t,subtitle:a,message:s,theme:n,id:o,closeNotification:l,styling:c,closeButton:r,onClick:d}=e;let m={},u={};return c&&(m.backgroundColor=c.backgroundTop,m.color=c.colorTop,u.backgroundColor=c.backgroundBottom,u.color=c.colorBottom),i.default.createElement("div",{className:"rpn-notification-card ".concat(n),onClick:d},i.default.createElement("div",{className:"rpn-notification-card-top ".concat(n),style:Object.keys(m).length?m:void 0},i.default.createElement("span",null,t),i.default.createElement("span",{className:"rpn-notification-card-close ".concat(n),onClick:()=>l(o)},r||"close")),i.default.createElement("div",{className:"rpn-notification-card-bottom ".concat(n),style:Object.keys(u).length?u:void 0},i.default.createElement("span",{className:"subtitle"},a),i.default.createElement("span",{className:"message"},s)))}},52932:function(e,t){var a=this&&this.__awaiter||function(e,t,a,s){return new(a||(a=Promise))((function(i,n){function o(e){try{c(s.next(e))}catch(t){n(t)}}function l(e){try{c(s.throw(e))}catch(t){n(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,l)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.PushNotification=void 0;class s{constructor(e){this.title=e.title,this.subtitle=e.subtitle,this.message=e.message,this.theme=e.theme,this.id=Math.random(),this.styling=e.styling,this.closeButton=e.closeButton,this.onClick=e.onClick}}t.PushNotification=s;t.default=new class{constructor(){this.Storage=[],this.Listener=()=>this.Storage,this.popAndPush=e=>{let t=0;for(;t<this.Storage.length;)this.Storage[t].id===e?this.Storage.splice(t,1):++t;this.Listener(this.Storage)},this.setTimer=(e,t)=>{setTimeout((()=>this.popAndPush(e)),t)},this.addListener=e=>{this.Listener=e},this.addNativeNotification=e=>a(this,void 0,void 0,(function*(){const{title:t,subtitle:a,message:s,duration:i,icon:n,vibrate:o,silent:l,onClick:c}=e;if("default"!==Notification.permission&&"denied"!==Notification.permission||(yield Notification.requestPermission()),"granted"===Notification.permission){const e=new Notification(t,{body:s,data:a,icon:n,vibrate:o,silent:l});e.onclick=c||null,setTimeout(e.close.bind(e),i||3e3)}})),this.addWebNotification=e=>{const{title:t,subtitle:a,message:i,theme:n,duration:o,backgroundBottom:l,backgroundTop:c,colorBottom:r,colorTop:d,closeButton:m,onClick:u}=e,h=new s({title:t,subtitle:a,message:i,theme:n,styling:{backgroundTop:c,backgroundBottom:l,colorTop:d,colorBottom:r},closeButton:m,onClick:u});this.Storage.push(h),this.setTimer(h.id,o||3e3),this.Listener(this.Storage)},this.addNotification=e=>a(this,void 0,void 0,(function*(){const{native:t}=e;return t?this.addNativeNotification(e):this.addWebNotification(e)}))}}},7969:(e,t,a)=>{a.r(t),a.d(t,{default:()=>s});const s={}},87462:(e,t,a)=>{function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},s.apply(this,arguments)}a.d(t,{Z:()=>s})},63366:(e,t,a)=>{function s(e,t){if(null==e)return{};var a,s,i={},n=Object.keys(e);for(s=0;s<n.length;s++)a=n[s],t.indexOf(a)>=0||(i[a]=e[a]);return i}a.d(t,{Z:()=>s})},89611:(e,t,a)=>{function s(e,t){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},s(e,t)}a.d(t,{Z:()=>s})}}]);
//# sourceMappingURL=618.6afc7f64.chunk.js.map