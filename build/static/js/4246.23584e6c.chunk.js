"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[4246],{75489:(e,a,t)=>{t.r(a),t.d(a,{default:()=>h});var s=t(55294),l=t(72791),c=t(583),n=t(24849),i=t(57689),r=t(2515),o=t(22120),m=t.n(o);const d=t.p+"static/media/greentick.ef2ae37034b7e6bd95f0.jpg";t(69517);var p=t(80184);const h=()=>{const e=(0,i.s0)(),{user:a}=(0,c.a)(),[t,o]=(0,l.useState)(!1),[h,u]=(0,l.useState)([]),[x,j]=(0,l.useState)([]),[f,b]=(0,l.useState)([]),[N,g]=(0,l.useState)({email:a.email,priority:"low",title:"",department:"",ticketType:"",status:"Open",projectType:"",dueDate:"",description:"",assigneeEmail:"",attachments:null}),[v,y]=(0,l.useState)(null);(0,l.useEffect)((()=>{!async function(){try{const e=await s.Z.get("http://api1.chandrakala.co.in/api/Users");b(e.data)}catch(e){console.error("Error fetching Assignee:",e)}}()}),[]),(0,l.useEffect)((()=>{!async function(){try{const e=await s.Z.get("http://api1.chandrakala.co.in/api/TicketTypes");u(e.data)}catch(e){console.error("Error fetching Ticket Type:",e)}}()}),[]),(0,l.useEffect)((()=>{!async function(){try{const e=await s.Z.get("http://api1.chandrakala.co.in/api/ProjectType");j(e.data)}catch(e){console.error("Error fetching Project Type:",e)}}()}),[]);const T=e=>{const{name:t,value:s}=e.target||e;if("assigneeEmail"===t){const e=f.find((e=>e.email===s)),l=s.toLowerCase()===a.email.toLowerCase(),c=l?e.departmentName:(null===e||void 0===e?void 0:e.departmentName)||"";g((e=>({...e,[t]:s,department:c,status:l?"Self-Assigned":"Open"})))}else g((e=>({...e,[t]:s})))};(0,l.useEffect)((()=>{const e=f.find((e=>e.email===N.assigneeEmail)),t=N.assigneeEmail.toLowerCase()===a.email.toLowerCase(),s=t?e.departmentName:(null===e||void 0===e?void 0:e.departmentName)||"";g((e=>({...e,department:s,status:t?"Self-Assigned":"Open"})))}),[N.assigneeEmail,f,a]);return(0,p.jsxs)("div",{className:"container mt-5",children:[(0,p.jsx)("div",{className:"d-flex justify-content-between"}),v&&(0,p.jsx)("div",{className:"alert ".concat(v.includes("successfully")?"alert-success":"alert-danger"),role:"alert",children:v}),(0,p.jsxs)("form",{onSubmit:async t=>{t.preventDefault(),o(!0);const l=Object.entries(N).map((e=>{let[a,t]=e;return"".concat(encodeURIComponent(a),"=").concat(encodeURIComponent(t))})).join("&"),c=new FormData;Object.entries(N).forEach((e=>{let[a,t]=e;if("attachments"===a){if(t)for(let s=0;s<t.length;s++)c.append("attachments",t[s])}else c.append(a,t)}));try{const t=await s.Z.post("".concat("http://api1.chandrakala.co.in/api/Tickets","?").concat(l),c,{headers:{"Content-Type":"multipart/form-data"}});console.log(t),y("Ticket added successfully!"),o(!1),m()({title:"Ticket",message:"New ticket has been assigned",duration:11e3,icon:d,native:!0,onClick:()=>window.location="".concat("http://test1.chandrakala.co.in")}),g({email:a.email,priority:"low",title:"",department:"",ticketType:"",status:"Open",projectType:"",dueDate:"",description:"",assigneeEmail:"",attachments:null}),e("/Tickets/AddTicket/".concat(t.data.userId))}catch(n){console.error(n),y("Error adding ticket. Please try again."),o(!1)}},children:[(0,p.jsxs)("div",{className:"row mb-3",children:[(0,p.jsx)("label",{htmlFor:"email",className:"col-sm-3 col-form-label text-end",children:"Creator"}),(0,p.jsx)("div",{className:"col-sm-3",children:(0,p.jsx)("input",{type:"text",className:"form-control",id:"email",name:"email",placeholder:"Enter your Email",required:!0,value:a.email,onChange:T,disabled:!0})}),(0,p.jsxs)("label",{htmlFor:"assigneeEmail",className:"col-sm-3 col-form-label text-end",children:["Assignee Email",(0,p.jsx)("span",{className:"text-danger",children:" * "})]}),(0,p.jsx)("div",{className:"col-sm-3",children:(0,p.jsx)(r.ZP,{options:f.map((e=>({label:e.email,value:e.email}))),value:{label:N.assigneeEmail,value:N.assigneeEmail},onChange:e=>T({target:{name:"assigneeEmail",value:e.value}}),isSearchable:!0,placeholder:"Select Assignee"})})]}),(0,p.jsxs)("div",{className:"row mb-3",children:[(0,p.jsxs)("label",{htmlFor:"title",className:"col-sm-3 col-form-label text-end",children:["Title",(0,p.jsx)("span",{className:"text-danger",children:" * "})]}),(0,p.jsx)("div",{className:"col-sm-3",children:(0,p.jsx)("input",{type:"text",className:"form-control",id:"title",name:"title",placeholder:"Enter title",required:!0,onChange:T})}),(0,p.jsxs)("label",{htmlFor:"priority",className:"col-sm-3 col-form-label text-end",children:["Priority",(0,p.jsx)("span",{className:"text-danger",children:" * "})]}),(0,p.jsx)("div",{className:"col-sm-3",children:(0,p.jsxs)("select",{className:"form-select",id:"priority",name:"priority",placeholder:"Select priority",required:!0,onChange:T,children:[(0,p.jsx)("option",{defaultValue:!0,children:"Select Priority"}),(0,p.jsx)("option",{value:"low",children:"Low"}),(0,p.jsx)("option",{value:"medium",children:"Medium"}),(0,p.jsx)("option",{value:"high",children:"High"})]})})]}),(0,p.jsxs)("div",{className:"row mb-3",children:[(0,p.jsxs)("label",{htmlFor:"ticketType",className:"col-sm-3 col-form-label text-end",children:["Ticket Type",(0,p.jsx)("span",{className:"text-danger",children:" * "})]}),(0,p.jsx)("div",{className:"col-sm-3",children:(0,p.jsx)(r.ZP,{options:h.map((e=>({label:e.ticketType,value:e.ticketType}))),value:{label:N.ticketType,value:N.ticketType},onChange:e=>T({target:{name:"ticketType",value:e.value}}),isSearchable:!0,placeholder:"Select Ticket Type"})}),(0,p.jsx)("label",{htmlFor:"status",className:"col-sm-3 col-form-label text-end",children:"Status"}),(0,p.jsx)("div",{className:"col-sm-3",children:(0,p.jsx)("input",{className:"form-control",id:"status",name:"status",value:N.status,required:!0,onChange:T,readOnly:!0,disabled:!0})})]}),(0,p.jsxs)("div",{className:"row mb-3",children:[(0,p.jsxs)("label",{htmlFor:"projectType",className:"col-sm-3 col-form-label text-end",children:["Project Type",(0,p.jsx)("span",{className:"text-danger",children:" * "})]}),(0,p.jsx)("div",{className:"col-sm-3",children:(0,p.jsx)(r.ZP,{options:x.map((e=>({label:e.projectTypes,value:e.projectTypes}))),value:{label:N.projectType,value:N.projectType},onChange:e=>T({target:{name:"projectType",value:e.value}}),isSearchable:!0,placeholder:"Select Project Type"})}),(0,p.jsxs)("label",{htmlFor:"dueDate",className:"col-sm-3 col-form-label text-end",children:["Due Date",(0,p.jsx)("span",{className:"text-danger",children:" * "})]}),(0,p.jsx)("div",{className:"col-sm-3",children:(0,p.jsx)("input",{type:"date",className:"form-control",id:"dueDate",name:"dueDate",placeholder:"Select Due Date",required:!0,onChange:T})})]}),(0,p.jsxs)("div",{className:"row mb-3",children:[(0,p.jsx)("label",{htmlFor:"ticketId",className:"col-sm-3 col-form-label text-end",children:"Ticket ID:"}),(0,p.jsx)("div",{className:"col-sm-3",children:(0,p.jsx)("input",{type:"text",className:"form-control",id:"ticketId",name:"ticketId",placeholder:"Ticket ID",required:!0,onChange:T,disabled:!0,value:"0"})}),(0,p.jsx)("label",{htmlFor:"department",className:"col-sm-3 col-form-label text-end",children:"Department"}),(0,p.jsx)("div",{className:"col-sm-3",children:(0,p.jsx)("input",{className:"form-control",id:"department",name:"department",value:N.department||"",required:!0,onChange:T,readOnly:!0,disabled:!0})})]}),(0,p.jsxs)("div",{className:"row mb-3",children:[(0,p.jsxs)("label",{htmlFor:"description",className:"col-sm-3 col-form-label text-end",children:["Description",(0,p.jsx)("span",{className:"text-danger",children:" * "})]}),(0,p.jsx)("div",{className:"col-sm-9",children:(0,p.jsx)("textarea",{className:"form-control",id:"description",name:"description",placeholder:"Enter description",rows:"4",required:!0,onChange:T})})]}),(0,p.jsxs)("div",{className:"row mb-3",children:[(0,p.jsx)("label",{htmlFor:"attachments",className:"col-sm-3 col-form-label text-end",children:"Attachments:"}),(0,p.jsx)("div",{className:"col-sm-9",children:(0,p.jsx)("input",{type:"file",className:"form-control",id:"attachments",name:"attachments",multiple:!0,onChange:e=>{g((a=>({...a,attachments:e.target.files})))}})})]}),(0,p.jsxs)("div",{className:"row mb-3",children:[(0,p.jsx)("div",{className:"col-sm-3"}),(0,p.jsx)("div",{className:"col-sm-9 text-end",children:(0,p.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:t,children:t?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(n.Z,{animation:"border",size:"sm"})," Adding Ticket..."]}):"Add Ticket"})})]})]})]})}}}]);
//# sourceMappingURL=4246.23584e6c.chunk.js.map