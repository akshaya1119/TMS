(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[276],{24220:(a,e,n)=>{"use strict";n.d(e,{R:()=>d});var t=n(72791),i=n(89704),c=n.n(i);const s={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_ARCHIEVED:"http://api1.chandrakala.co.in/api/Tickets/ArchivedByUser",REACT_APP_API_CHANGE_PASSWORD:"http://api1.chandrakala.co.in/api/Login/ChangePassword",REACT_APP_API_DEPARTMENTS:"http://api1.chandrakala.co.in/api/Departments",REACT_APP_API_DESIGNATION:"http://api1.chandrakala.co.in/api/Designation",REACT_APP_API_Filter:"http://api1.chandrakala.co.in/api/Tickets/filter",REACT_APP_API_FORGOT_PASSWORD:"http://api1.chandrakala.co.in/api/Login/ForgetPassword",REACT_APP_API_LOGIN:"http://api1.chandrakala.co.in/api/Login",REACT_APP_API_MODULE:"http://api1.chandrakala.co.in/api/Modules",REACT_APP_API_PERMISSION:"http://api1.chandrakala.co.in/api/Permission",REACT_APP_API_PROJECTTYPE:"http://api1.chandrakala.co.in/api/ProjectType",REACT_APP_API_SavedSearch:"http://api1.chandrakala.co.in/api/SearchSave",REACT_APP_API_TICKET:"http://api1.chandrakala.co.in/api/Tickets",REACT_APP_API_TICKETFLOW:"http://api1.chandrakala.co.in/api/TicketFlow",REACT_APP_API_TICKETFLOW_BY_COMMENTS:"http://api1.chandrakala.co.in/api/TicketFlow/CommentsByTicketId",REACT_APP_API_TICKETTYPE:"http://api1.chandrakala.co.in/api/TicketTypes",REACT_APP_API_TICKET_COMPLETED:"http://api1.chandrakala.co.in/api/Tickets/MarkCompleted",REACT_APP_API_UPLOAD:"http://api1.chandrakala.co.in/api/Users/upload",REACT_APP_API_USERS:"http://api1.chandrakala.co.in/api/Users",REACT_APP_API_USER_BY_ID:"http://api1.chandrakala.co.in/api/Users",REACT_APP_BASE_API_URL:"http://api1.chandrakala.co.in/api",REACT_APP_BASE_URL:"http://api1.chandrakala.co.in",REACT_APP_MY_SERVER:"http://ticket.chandrakala.co.in"}.REACT_APP_SECRET_KEY||"ghjsfysdg123",r=(0,t.createContext)({encrypt:a=>c().AES.encrypt(a.toString(),s).toString().replace(/\//g,";"),decrypt:a=>{if("string"!==typeof a)return a;a=a.replace(/;/g,"/");return c().AES.decrypt(a,s).toString(c().enc.Utf8)}}),d=()=>(0,t.useContext)(r)},42922:(a,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>C});var t=n(72791),i=n(47022),c=n(30018),s=n(89743),r=n(2677),d=n(54694),l=n(29795),o=n(62591),h=n(43360),p=(n(77632),n(55294)),_=n(24220),A=n(36704),P=n(57689),E=n(583),y=n(80184);const T="http://api1.chandrakala.co.in",C=a=>{let{userId:e}=a;const{user:n}=(0,E.a)(),{encrypt:C}=(0,_.R)(),[k,O]=(0,t.useState)([]),[u,m]=(0,t.useState)([]),[I,R]=(0,t.useState)(!1),[S,g]=(0,t.useState)(""),[x,j]=(0,t.useState)(""),[w,U]=(0,t.useState)(null),D=(0,P.s0)();(0,t.useEffect)((()=>{(async()=>{try{const a=await p.Z.get("".concat(T,"/api/Permission/ByUser/").concat(e),{headers:{Authorization:"Bearer ".concat(null===n||void 0===n?void 0:n.token)}});a.data&&0===a.data.length?j("No permissions have been assigned to this user. Thank You"):(O(a.data),j(""))}catch(a){console.error("Error fetching permissions:",a),j("Error fetching permissions.")}})(),(async()=>{try{const a=await p.Z.get("".concat(T,"/api/Modules"),{headers:{Authorization:"Bearer ".concat(null===n||void 0===n?void 0:n.token)}});m(a.data)}catch(a){console.error("Error fetching modules:",a),j("Error fetching modules. Please try again.")}})()}),[e]);const f=async(a,e,t)=>{R(!0),j("");try{const i=k.map((n=>n.permission_Id===a?"canViewOnly"!==e||t?{...n,[e]:t,..."canViewOnly"===e&&t?{canAddOnly:!1,canUpdateOnly:!1,canDeleteOnly:!1}:"canAddOnly"===e&&t?{canViewOnly:!0}:"canUpdateOnly"===e&&t?{canViewOnly:!0,canAddOnly:!0}:"canDeleteOnly"===e&&t?{canViewOnly:!0,canAddOnly:!0,canUpdateOnly:!0}:{}}:{...n,canViewOnly:!1,canAddOnly:!1,canUpdateOnly:!1,canDeleteOnly:!1}:n));O(i),U(a);const c=i.find((e=>e.permission_Id===a));if(!c)return void j("Updated permission not found. Please try again.");const{permission_Id:s,userID:r,id:d,canAddOnly:l,canDeleteOnly:o,canUpdateOnly:h,canViewOnly:_}=c;await p.Z.put("".concat(T,"/api/Permission/").concat(s),{permission_Id:s,userID:r,id:d,canAddOnly:l,canDeleteOnly:o,canUpdateOnly:h,canViewOnly:_},{headers:{Authorization:"Bearer ".concat(null===n||void 0===n?void 0:n.token)}}),g("Permissions updated successfully")}catch(i){console.error("Error updating permissions:",i),j("Error updating permissions. Please try again.")}finally{R(!1)}},v=()=>{D("/Users/AddPermissions/".concat(C(e)))},Z=a=>{const e=u.find((e=>e.id===a));return e?e.name:"Unknown"};return(0,y.jsx)(A.Z,{children:a=>{let{hasPermission:e}=a;return e(7,"canUpdateOnly")&&(0,y.jsxs)(i.Z,{children:[S&&!I&&(0,y.jsx)(c.Z,{variant:"success",className:"mt-3",children:S}),x&&!I&&(0,y.jsx)(c.Z,{variant:"danger",className:"mt-3",children:x}),(0,y.jsx)(s.Z,{className:"justify-content-center",children:(0,y.jsx)(r.Z,{md:12,children:(0,y.jsxs)(d.Z,{children:[(0,y.jsx)(d.Z.Header,{as:"h5",className:"text-center",children:"Update Permissions"}),(0,y.jsx)(d.Z.Body,{children:(0,y.jsx)(l.Z,{className:"table-responsive",children:(0,y.jsxs)(o.Z,{bordered:!0,children:[(0,y.jsx)("thead",{children:(0,y.jsxs)("tr",{children:[(0,y.jsx)("th",{children:"Module Name"}),(0,y.jsx)("th",{children:"Can View"}),(0,y.jsx)("th",{children:"Can Add"}),(0,y.jsx)("th",{children:"Can Update"}),(0,y.jsx)("th",{children:"Can Delete"})]})}),(0,y.jsx)("tbody",{children:k.length>0?k.map((a=>(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{children:Z(a.id)}),(0,y.jsx)("td",{children:(0,y.jsx)(l.Z.Check,{type:"switch",id:"".concat(Z(a.id),"-canview-switch"),label:"",checked:a.canViewOnly,onChange:e=>f(a.permission_Id,"canViewOnly",e.target.checked)})}),(0,y.jsx)("td",{children:(0,y.jsx)(l.Z.Check,{type:"switch",id:"".concat(Z(a.id),"-canadd-switch"),label:"",checked:a.canAddOnly,onChange:e=>f(a.permission_Id,"canAddOnly",e.target.checked)})}),(0,y.jsx)("td",{children:(0,y.jsx)(l.Z.Check,{type:"switch",id:"".concat(Z(a.id),"-canupdate-switch"),label:"",checked:a.canUpdateOnly,onChange:e=>f(a.permission_Id,"canUpdateOnly",e.target.checked)})}),(0,y.jsx)("td",{children:(0,y.jsx)(l.Z.Check,{type:"switch",id:"".concat(Z(a.id),"-candelete-switch"),label:"",checked:a.canDeleteOnly,onChange:e=>f(a.permission_Id,"canDeleteOnly",e.target.checked)})})]},a.permission_Id))):(0,y.jsx)("tr",{children:(0,y.jsxs)("td",{colSpan:"5",className:"text-center",children:[x,(0,y.jsx)(h.Z,{variant:"primary",onClick:v,children:"Assign Permissions"})]})})})]})})})]})})})]})}})}},42480:()=>{}}]);
//# sourceMappingURL=276.f1a2aacd.chunk.js.map