(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[7975],{24220:(e,t,a)=>{"use strict";a.d(t,{R:()=>c});var n=a(72791),i=a(89704),s=a.n(i);const r={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_ARCHIEVED:"http://api1.chandrakala.co.in/api/Tickets/ArchivedByUser",REACT_APP_API_CHANGE_PASSWORD:"http://api1.chandrakala.co.in/api/Login/ChangePassword",REACT_APP_API_DEPARTMENTS:"http://api1.chandrakala.co.in/api/Departments",REACT_APP_API_DESIGNATION:"http://api1.chandrakala.co.in/api/Designation",REACT_APP_API_Filter:"http://api1.chandrakala.co.in/api/Tickets/filter",REACT_APP_API_FORGOT_PASSWORD:"http://api1.chandrakala.co.in/api/Login/ForgetPassword",REACT_APP_API_LOGIN:"http://api1.chandrakala.co.in/api/Login",REACT_APP_API_MODULE:"http://api1.chandrakala.co.in/api/Modules",REACT_APP_API_PERMISSION:"http://api1.chandrakala.co.in/api/Permission",REACT_APP_API_PROJECTTYPE:"http://api1.chandrakala.co.in/api/ProjectType",REACT_APP_API_SavedSearch:"http://api1.chandrakala.co.in/api/SearchSave",REACT_APP_API_TICKET:"http://api1.chandrakala.co.in/api/Tickets",REACT_APP_API_TICKETFLOW:"http://api1.chandrakala.co.in/api/TicketFlow",REACT_APP_API_TICKETFLOW_BY_COMMENTS:"http://api1.chandrakala.co.in/api/TicketFlow/CommentsByTicketId",REACT_APP_API_TICKETTYPE:"http://api1.chandrakala.co.in/api/TicketTypes",REACT_APP_API_TICKET_COMPLETED:"http://api1.chandrakala.co.in/api/Tickets/MarkCompleted",REACT_APP_API_UPLOAD:"http://api1.chandrakala.co.in/api/Users/upload",REACT_APP_API_USERS:"http://api1.chandrakala.co.in/api/Users",REACT_APP_API_USER_BY_ID:"http://api1.chandrakala.co.in/api/Users",REACT_APP_BASE_API_URL:"http://api1.chandrakala.co.in/api",REACT_APP_BASE_URL:"http://api1.chandrakala.co.in",REACT_APP_MY_SERVER:"http://ticket.chandrakala.co.in"}.REACT_APP_SECRET_KEY||"ghjsfysdg123",l=(0,n.createContext)({encrypt:e=>s().AES.encrypt(e.toString(),r).toString().replace(/\//g,";"),decrypt:e=>{if("string"!==typeof e)return e;e=e.replace(/;/g,"/");return s().AES.decrypt(e,r).toString(s().enc.Utf8)}}),c=()=>(0,n.useContext)(l)},92536:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>O});var n=a(72791),i=a(62591),s=a(97873),r=a(12576),l=a(43360),c=a(17612),o=a(11087),d=a(88890),h=a.n(d),p=a(9806),u=a(11632),x=a(55294),m=a(24220),j=a(583),v=a(80184);const k=e=>{let{tickets:t,hasPermission:a,setTickets:d}=e;const[k,f]=(0,n.useState)(!1),[g,T]=(0,n.useState)(null),[y,A]=(0,n.useState)({}),S=(0,n.useRef)(null),[C,P]=(0,n.useState)(!1),[_,E]=(0,n.useState)(!1),{encrypt:b}=(0,m.R)(),{user:N}=(0,j.a)();(0,n.useEffect)((()=>{t.forEach((e=>{(async e=>{try{const t=await fetch("".concat("http://api1.chandrakala.co.in/api/TicketFlow/CommentsByTicketId","/").concat(e),{headers:{Authorization:"Bearer ".concat(null===N||void 0===N?void 0:N.token)}});if(!t.ok)throw new Error("HTTP error! Status: ".concat(t.status));const a=await t.json(),n=a.length>0?a[a.length-1].comment:"No comments";A((t=>({...t,[e]:n})))}catch(t){console.error("Error fetching comments for ticket ".concat(e,":"),t)}})(e.ticketId)}))}),[t,null===N||void 0===N?void 0:N.token]),(0,n.useEffect)((()=>{S.current&&h()(S.current).DataTable({aLengthMenu:[100]})}),[]);const I=()=>{T(null),P(!1)},w=async()=>{if(g&&null!==N&&void 0!==N&&N.token&&null!==N&&void 0!==N&&N.userId){try{await x.Z.post("".concat("http://api1.chandrakala.co.in/api/Tickets","/").concat(g.ticketId,"/archive?userId=").concat(N.userId),{userId:N.userId},{headers:{Authorization:"Bearer ".concat(N.token)}});d(t.filter((e=>e.ticketId!==g.ticketId)))}catch(e){console.error("Error archiving ticket:",e.response?e.response.data:e.message)}I()}else console.error("Missing required information for archiving ticket.")};return(0,v.jsxs)("div",{className:"mt-6 table-responsive",children:[(0,v.jsxs)(i.Z,{ref:S,striped:!0,bordered:!0,hover:"sm",children:[(0,v.jsx)("thead",{children:(0,v.jsxs)("tr",{children:[(0,v.jsx)("th",{children:"S.No"}),(0,v.jsx)("th",{children:"TicketID"}),(0,v.jsx)("th",{children:"Title"}),(0,v.jsx)("th",{children:"Status"}),(0,v.jsx)("th",{children:"Priority"}),(0,v.jsx)("th",{children:"TicketType"}),(0,v.jsx)("th",{children:"DueDate"}),(0,v.jsx)("th",{children:"Department"}),(0,v.jsx)("th",{children:"Project"}),(0,v.jsx)("th",{children:"Actions"})]})}),(0,v.jsx)("tbody",{children:t.map(((e,t)=>(0,v.jsxs)("tr",{children:[(0,v.jsx)("td",{children:t+1}),(0,v.jsx)("td",{children:e.ticketId}),(0,v.jsx)("td",{children:(0,v.jsx)(s.Z,{placement:"top",delay:{show:250,hide:400},overlay:(0,v.jsx)(r.Z,{id:"tooltip-".concat(e.ticketId),children:y[e.ticketId]?(0,v.jsxs)(v.Fragment,{children:["Last comment:",(0,v.jsx)("div",{dangerouslySetInnerHTML:{__html:y[e.ticketId]}})]}):(0,v.jsxs)("div",{children:["Description: ",(0,v.jsx)("br",{}),e.description]})}),children:(0,v.jsx)("span",{className:"text-truncate d-inline-block ",style:{maxWidth:"150px"},children:e.title})},e.ticketId)}),(0,v.jsx)("td",{children:e.status}),(0,v.jsx)("td",{children:e.priority}),(0,v.jsx)("td",{children:e.ticketType}),(0,v.jsx)("td",{children:new Date(e.dueDate).toLocaleDateString()}),(0,v.jsx)("td",{children:e.department}),(0,v.jsx)("td",{children:e.project}),(0,v.jsx)("td",{children:(0,v.jsxs)("div",{className:"d-flex gap-3 align-items-center",children:[a(2,"canUpdateOnly")&&(0,v.jsx)(o.rU,{to:"EditTicket/".concat(b(e.ticketId)),children:(0,v.jsx)(p.G,{icon:u.e0A,className:"text-primary"})}),a(2,"canViewOnly")&&(0,v.jsx)(l.Z,{variant:"link",onClick:()=>(e=>{T(e),f(!0)})(e),children:(0,v.jsx)(p.G,{icon:u.Mdf,className:"text-success"})}),a(2,"canDeleteOnly")&&(0,v.jsx)(p.G,{icon:u.On6,className:"text-danger",onClick:()=>(e=>{T(e),P(!0)})(e)}),(0,v.jsxs)(c.Z,{show:C,onHide:I,children:[(0,v.jsx)(c.Z.Header,{closeButton:!0,children:(0,v.jsx)(c.Z.Title,{children:"Confirm Archive"})}),(0,v.jsxs)(c.Z.Body,{children:["Are you sure you want to archive ticket ",g?g.id:"","?"]}),(0,v.jsxs)(c.Z.Footer,{children:[(0,v.jsx)(l.Z,{variant:"secondary",onClick:I,children:"Cancel"}),(0,v.jsx)(l.Z,{variant:"danger",onClick:w,children:"Archive"})]})]})]})})]},e.ticketId)))})]}),g&&(0,v.jsxs)(c.Z,{show:k,onHide:()=>f(!1),size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[(0,v.jsx)(c.Z.Header,{closeButton:!0,children:(0,v.jsx)(c.Z.Title,{id:"contained-modal-title-vcenter",children:"Ticket Details"})}),(0,v.jsxs)(c.Z.Body,{children:[(0,v.jsxs)("p",{children:["Title: ",g.title]}),(0,v.jsxs)("p",{children:["Description: ",g.description]}),(0,v.jsxs)("p",{children:["Creator: ",g.creatorName]}),(0,v.jsxs)("p",{children:["Assignee: ",g.assigneeName]}),(0,v.jsx)("p",{children:"Attachments:"}),g.attachment&&(0,v.jsx)("div",{children:g.attachment.split(";").map(((e,t)=>{const a=/\.(png|jpg|jpeg|gif|bmp)$/i.test(e),n="".concat("http://api1.chandrakala.co.in","/").concat(e.replace("wwwroot/",""));return(0,v.jsx)("div",{className:"mb-2",children:a?(0,v.jsx)("img",{src:n,alt:"Attachment ".concat(t+1),className:"img-fluid",style:{maxWidth:"100%",height:"auto"}}):(0,v.jsx)("p",{children:(0,v.jsxs)("a",{href:n,target:"_blank",rel:"noopener noreferrer",children:["View Attachment ",t+1]})})},t)}))})]}),(0,v.jsx)(c.Z.Footer,{children:(0,v.jsx)(l.Z,{onClick:()=>f(!1),children:"Close"})})]})]})};var f=a(24849),g=a(36704),T=a(57689),y=a(47022),A=a(29795);const S=e=>{let{availableFilters:t,handleFilterSelect:a}=e;return(0,v.jsx)("div",{className:"row",children:(0,v.jsx)("div",{className:"col-sm-6",children:(0,v.jsxs)("div",{className:"d-flex align-items-center",children:[(0,v.jsx)("label",{htmlFor:"filter-select",className:"me-2 mb-0 fs-34",children:"Select Filter:"}),(0,v.jsxs)("select",{id:"filter-select",className:"form-select",onChange:e=>a(e.target.value),children:[(0,v.jsx)("option",{value:"",children:"Filter"}),t.map((e=>(0,v.jsx)("option",{value:e,children:e},e)))]})]})})})};var C=a(13071);const P=e=>{let{selectedFilters:t,filterOptions:a,handleOptionSelect:n,handleRemoveFilter:i,selectedDate:s,setSelectedDate:r}=e;const c=a||{};return(0,v.jsx)("div",{className:"flex-fill",children:(0,v.jsx)("div",{className:"col-sm-9",children:t.map((e=>{let{filter:t,selectedOption:a}=e;return(0,v.jsxs)("div",{className:"d-flex align-items-center mb-2",children:[(0,v.jsxs)("span",{className:"me-2",children:[t,":"]}),"DueDate"===t?(0,v.jsx)("input",{type:"date",className:"form-control",value:s||"",onChange:e=>{console.log("DatePicker Selected Date:",e.target.value),r(e.target.value),n(t,e.target.value)}}):"Title"===t?(0,v.jsx)(A.Z.Control,{type:"text",placeholder:"Search Title",value:a||"",onChange:e=>n(t,e.target.value),className:"form-control"}):(0,v.jsx)("div",{className:"form-select-wrapper",children:(0,v.jsxs)("select",{id:"select-options-".concat(t),className:"form-select",value:a||"",onChange:e=>n(t,e.target.value),children:[(0,v.jsx)("option",{value:"",children:"Select Option"}),(c[t]||[]).map((e=>{let{label:t}=e;return(0,v.jsx)("option",{value:t,children:t},t)}))]})}),(0,v.jsx)(l.Z,{variant:"danger",className:"ms-2",onClick:()=>i(t),children:(0,v.jsx)(C.iFH,{})})]},t)}))})})},_=e=>{let{showSaveModal:t,handleCloseSaveModal:a,filterName:n,setFilterName:i,handleSaveNewFilter:s,handleConfirmClose:r}=e;return(0,v.jsxs)(c.Z,{show:t,onHide:a,children:[(0,v.jsx)(c.Z.Header,{closeButton:!0,children:(0,v.jsx)(c.Z.Title,{children:"Save Search Filter"})}),(0,v.jsx)(c.Z.Body,{children:(0,v.jsxs)(A.Z.Group,{controlId:"filterName",children:[(0,v.jsx)(A.Z.Label,{children:"Filter Name"}),(0,v.jsx)(A.Z.Control,{type:"text",placeholder:"Enter filter name",value:n,onChange:e=>i(e.target.value)})]})}),(0,v.jsxs)(c.Z.Footer,{children:[(0,v.jsx)(l.Z,{variant:"secondary",onClick:a,children:"Cancel"}),(0,v.jsx)(l.Z,{variant:"primary",onClick:()=>{s(),r()},children:"Save"})]})]})},E=e=>{let{showCloseModal:t,handleCloseCloseModal:a,handleConfirmClose:n,hasUnsavedChanges:i,handleOpenSaveModal:s,selectedSavedFilter:r,handleSaveFilter:o}=e;return(0,v.jsxs)(c.Z,{show:t,onHide:a,children:[(0,v.jsx)(c.Z.Header,{closeButton:!0,children:(0,v.jsx)(c.Z.Title,{children:"Unsaved Changes"})}),(0,v.jsx)(c.Z.Body,{children:"You have unsaved changes. Do you want to save them before closing?"}),(0,v.jsxs)(c.Z.Footer,{children:[(0,v.jsx)(l.Z,{variant:"secondary",onClick:a,children:"Cancel"}),(0,v.jsx)(l.Z,{variant:"primary",onClick:n,children:"Discard Changes"}),i&&(0,v.jsx)(l.Z,{variant:"primary",onClick:r?o:s,children:"Save Changes"})]})]})},b="http://api1.chandrakala.co.in/api/SearchSave",N=e=>{let{onApplyFilters:t,fetchTickets:a}=e;const[i,s]=(0,n.useState)(!1),[r,c]=(0,n.useState)([]),[o,d]=(0,n.useState)({}),[h,p]=(0,n.useState)([]),[u,m]=(0,n.useState)(!1),[k,f]=(0,n.useState)(!1),[g,T]=(0,n.useState)(""),[N,I]=(0,n.useState)([]),[w,D]=(0,n.useState)(null),[Z,O]=(0,n.useState)(null),[F,R]=(0,n.useState)([]),[M,B]=(0,n.useState)([]),[L,U]=(0,n.useState)([]),[H,z]=(0,n.useState)({}),[G,K]=(0,n.useState)([]),[W,Y]=(0,n.useState)(!1),[J,V]=(0,n.useState)(null),[q,X]=(0,n.useState)("mysearch"),{user:$}=(0,j.a)(),Q=(e,t,a)=>({"Assigned by":a.map((e=>({label:e.fullName,value:e.userId}))),"Assigned To":a.map((e=>({label:e.fullName,value:e.userId}))),DueDate:[],Project:t.map((e=>({label:e.projectTypes,value:e.projectId}))),Priority:["High","Medium","Low"].map((e=>({label:e,value:e}))),Status:["Open","Self-Assigned","Pending","Completed"].map((e=>({label:e,value:e}))),Title:[],"Ticket Type":e.map((e=>({label:e.ticketType,value:e.ticketTypeId})))});(0,n.useEffect)((()=>{!async function(){try{const e=await x.Z.get("http://api1.chandrakala.co.in/api/TicketTypes",{headers:{Authorization:"Bearer ".concat(null===$||void 0===$?void 0:$.token)}});R(e.data||[]);const t=await x.Z.get("http://api1.chandrakala.co.in/api/ProjectType",{headers:{Authorization:"Bearer ".concat(null===$||void 0===$?void 0:$.token)}});B(t.data||[]);const a=await x.Z.get("http://api1.chandrakala.co.in/api/Users",{headers:{Authorization:"Bearer ".concat(null===$||void 0===$?void 0:$.token)}});U(a.data||[]);const n=await x.Z.get(b,{headers:{Authorization:"Bearer ".concat(null===$||void 0===$?void 0:$.token)}});I(n.data||[])}catch(e){console.error("Error fetching data:",e)}}()}),[null===$||void 0===$?void 0:$.token]),(0,n.useEffect)((()=>{const e=Q(F,M,L);p(Object.keys(e)),d(e)}),[F,M,L]),(0,n.useEffect)((()=>{K(r)}),[r]),(0,n.useEffect)((()=>{w&&ae(w)}),[w]),(0,n.useEffect)((()=>{JSON.stringify(r)!==JSON.stringify(G)?Y(!0):Y(!1)}),[r]),(0,n.useEffect)((()=>{console.log("Updated selectedFilters:",r)}),[r]);const ee=async()=>{try{const e=await x.Z.get("http://api1.chandrakala.co.in/api/Tickets/filter",{params:H,headers:{Authorization:"Bearer ".concat($.token)}});t(e.data)}catch(e){console.error("Error:",e)}},te=()=>m(!1),ae=e=>{const t=N.find((t=>t.name===e));if(t){const a=JSON.parse(t.config),n=Object.entries(a);c(n.map((e=>{let[t,a]=e;return{filter:t,selectedOption:a}})));const i=Q(F,M,L);p(Object.keys(i).filter((e=>!n.map((e=>{let[t]=e;return t})).includes(e)))),d(i);const s=n.reduce(((e,t)=>{var a;let[n,i]=t;const s=n.replace(" ","")+(["Ticket Type","Project","Assigned by","Assigned To"].includes(n)?"Id":""),r=null===(a=o[n])||void 0===a?void 0:a.find((e=>e.label===i));return e[s]=r?r.value:i,e}),{});z(s),X(e),ee()}D(e),Y(!1)},ne=async()=>{c([]),z({}),p(Object.keys(o)),Y(!1),D(null),a(),f(!1),s(!1)};return(0,v.jsxs)(y.Z,{className:"border border-3 p-4 my-3",children:[(0,v.jsxs)("div",{children:[(0,v.jsx)("div",{className:"text-end mb-3",children:(0,v.jsx)(l.Z,{onClick:i?()=>{W?f(!0):(c([]),Y(!1),z({}),D(""),a(),s(!1))}:()=>s(!0),children:i?"Close":"Advanced Search"})}),i&&(0,v.jsx)("div",{className:"advanced-search-box mb-3",children:(0,v.jsxs)("div",{className:"row",children:[(0,v.jsx)("div",{className:" d-flex align-items-center justify-content-between",children:(0,v.jsx)("div",{className:" mb-3 text-end",children:(0,v.jsxs)(A.Z.Control,{as:"select",value:w||"",onChange:e=>ae(e.target.value),children:[(0,v.jsx)("option",{value:"",children:"Select Saved Filter"}),null===N||void 0===N?void 0:N.map((e=>{let{name:t}=e;return(0,v.jsx)("option",{value:t,children:t},t)}))]})})}),(0,v.jsxs)("div",{className:"row",children:[(0,v.jsx)("div",{className:"col-sm-6",children:(0,v.jsx)(S,{availableFilters:h,handleFilterSelect:e=>{p((t=>t.filter((t=>t!==e))));o[e];c((t=>[...t,{filter:e,selectedOption:null}])),Y(!0)}})}),(0,v.jsx)("div",{className:"col-sm-6",children:o&&(0,v.jsx)(P,{selectedFilters:r||[],filterOptions:o,handleOptionSelect:(e,t)=>{let a;if("Title"===e)a=t;else if("DueDate"===e){console.log("Original Date Option:",t);const e=new Date(t);console.log("Date Object:",e),a=e.toISOString().replace("T"," ").split(".")[0],console.log("Formatted Date:",a)}else{var n;a=null===(n=o[e])||void 0===n?void 0:n.find((e=>e.label===t))}if(console.log("Selected Option:",a),c((t=>t.map((t=>{var n;return t.filter===e?{...t,selectedOption:"Title"===e?a:null===(n=a)||void 0===n?void 0:n.label}:t})))),"DueDate"===e)z((e=>({...e,DueDate:a})));else{const t=["Ticket Type","Project","Assigned by","Assigned To"],n=e.replace(" ","")+(t.includes(e)?"Id":"");z((t=>{var i;return{...t,[n]:"Title"===e?a:null===(i=a)||void 0===i?void 0:i.value}}))}Y(!0)},handleRemoveFilter:e=>{c((t=>t.filter((t=>t.filter!==e)))),p((t=>[...t,e])),z((t=>{const a={...t};return delete a[e.replace(" ","")+(["Ticket Type","Project","Assigned by","Assigned To"].includes(e)?"Id":"")],a})),Y(!0)},selectedDate:Z,setSelectedDate:O})})]}),(0,v.jsx)("div",{className:"text-end mt-3",children:w?(0,v.jsxs)(l.Z,{type:"button",className:"btn btn-danger me-2",onClick:async()=>{if(w){console.log("Selected Saved Filter:",w);const t=N.find((e=>e.name===w));if(t&&t.id){console.log("Preparing to delete filter:",t);try{const e=await x.Z.delete("".concat(b,"/").concat(t.id),{headers:{Authorization:"Bearer ".concat(null===$||void 0===$?void 0:$.token)}});204===e.status?(I((e=>e.filter((e=>e.id!==t.id)))),c([]),D(null),V("Search deleted successfully"),await ne()):console.warn("Unexpected response status:",e.status)}catch(e){console.error("Error deleting filter:",e.response||e.message||e)}}else console.warn("No matching filter found to delete")}else console.warn("No filter selected to delete")},children:[(0,v.jsx)(C.Xm5,{})," Delete"]}):(0,v.jsx)(l.Z,{type:"button",className:"btn btn-primary me-2",onClick:ee,children:"Apply"})})]})})]}),(0,v.jsx)(_,{showSaveModal:u,handleCloseSaveModal:te,filterName:g,setFilterName:T,handleSaveNewFilter:async()=>{const e={name:g,config:JSON.stringify(r.reduce(((e,t)=>{let{filter:a,selectedOption:n}=t;return n&&(e[a]=n),e}),{}))};try{await x.Z.post(b,e,{headers:{Authorization:"Bearer ".concat(null===$||void 0===$?void 0:$.token),"Content-Type":"application/json"}});I((t=>[...t,e])),V("Search saved successfully"),T(""),te(),ne()}catch(t){console.error("Error saving filter:",t)}},handleConfirmClose:ne}),(0,v.jsx)(E,{showCloseModal:k,handleCloseCloseModal:()=>f(!1),handleConfirmClose:ne,hasUnsavedChanges:W,handleSaveFilter:async()=>{if(w){const t={id:N.find((e=>e.name===w)).id,name:w,config:JSON.stringify(r.reduce(((e,t)=>{let{filter:a,selectedOption:n}=t;return n&&(e[a]=n),e}),{}))};try{await x.Z.put("".concat(b,"/").concat(N.find((e=>e.name===w)).id),t,{headers:{Authorization:"Bearer ".concat(null===$||void 0===$?void 0:$.token),"Content-Type":"application/json"}}),I((e=>e.map((e=>e.name===w?t:e)))),V("Filter updated successfully"),T(""),te(),ne()}catch(e){console.error("Error saving filter:",e)}}else m(!0)},handleOpenSaveModal:()=>{m(!0),f(!1)},selectedSavedFilter:w})]})};var I=a(34045),w=a(35125);a(31052);const D=e=>{let{tickets:t}=e;const[a,i]=(0,n.useState)(!1),s=e=>{const t="Tickets";"PDF"===e?r(t):"Excel"===e&&c(t),i(!1)},r=e=>{try{const a=new w.default,n=["S.No","TicketID","Title","Status","Priority","TicketType","DueDate","Department","Project"],i=t.map(((e,t)=>[t+1,e.ticketId,e.title,e.status,e.priority,e.ticketType,new Date(e.dueDate).toLocaleDateString(),e.department,e.project]));a.autoTable(n,i,{startY:20}),a.text(e,14,15),a.save("".concat(e,".pdf"))}catch(a){console.error("Error exporting to PDF:",a)}},c=e=>{try{const a=I.P6.json_to_sheet(t),n=I.P6.book_new();I.P6.book_append_sheet(n,a,"Sheet1"),I.NC(n,"".concat(e,".xlsx"))}catch(a){console.error("Error exporting to Excel:",a)}},o={display:a?"flex":"none",flexDirection:"column",position:"absolute",top:"100%",right:0,backgroundColor:"white",border:"1px solid #ddd",borderRadius:"4px",boxShadow:"0px 8px 16px rgba(0, 0, 0, 0.2)",zIndex:1e3},d={padding:"8px 16px",border:"none",background:"none",textAlign:"left",cursor:"pointer"},h="#f1f1f1";return(0,v.jsxs)("div",{style:{position:"relative",display:"inline-block"},children:[(0,v.jsx)(l.Z,{className:"btn-secondary",onClick:()=>{i(!a)},children:(0,v.jsx)(p.G,{icon:u.q7m,style:{cursor:"pointer"}})}),(0,v.jsxs)("div",{style:o,children:[(0,v.jsx)("button",{style:d,onMouseEnter:e=>e.target.style.backgroundColor=h,onMouseLeave:e=>e.target.style.backgroundColor="none",onClick:()=>s("PDF"),children:"Export as PDF"}),(0,v.jsx)("button",{style:d,onMouseEnter:e=>e.target.style.backgroundColor=h,onMouseLeave:e=>e.target.style.backgroundColor="none",onClick:()=>s("Excel"),children:"Export as Excel"})]})]})},Z="http://api1.chandrakala.co.in/api/Tickets",O=()=>{const[e,t]=(0,n.useState)([]),[a,i]=(0,n.useState)(!0),{user:s}=(0,j.a)(),r=(0,T.s0)(),c=()=>{r("/Tickets/AddTicket")},o=async()=>{try{const e="".concat(Z,"?userId=").concat(s.userId),a={headers:{Authorization:"Bearer ".concat(s.token)}},n=await async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{const a=await fetch(e,t);if(!a.ok)throw new Error("HTTP error! Status: ".concat(a.status));return await a.json()}catch(a){throw console.error("Error fetching data:",a),a}}(e,a);t(n)}catch(e){console.error("Error fetching tickets:",e)}finally{i(!1)}};(0,n.useEffect)((()=>{s.userId&&o()}),[Z,s.userId,s.token]);const d=e=>{t(e)};return(0,v.jsx)(g.Z,{children:n=>{let{hasPermission:i}=n;return(0,v.jsxs)("div",{children:[(0,v.jsx)("div",{children:(0,v.jsx)(N,{onApplyFilters:d,fetchTickets:o})}),(0,v.jsxs)("div",{className:"d-flex justify-content-between mb-3",children:[(0,v.jsx)("h4",{children:"All Tickets"}),(0,v.jsxs)("div",{className:"d-flex gap-2    align-items-center",children:[(0,v.jsx)(D,{tickets:e,setTickets:t}),i(2,"canAddOnly")&&(0,v.jsx)(l.Z,{type:"button",className:"btn btn-primary",onClick:c,children:"Add Ticket"})]})]}),(0,v.jsx)("div",{children:a?(0,v.jsx)("div",{className:"text-center",children:(0,v.jsx)(f.Z,{animation:"border",role:"status",children:(0,v.jsx)("span",{className:"visually-hidden",children:"loading.."})})}):(0,v.jsx)(k,{tickets:e,hasPermission:i,setTickets:t})})]})}})}},42480:()=>{}}]);
//# sourceMappingURL=7975.fb2c861f.chunk.js.map