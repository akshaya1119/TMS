(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[9561,9958],{24220:(e,t,n)=>{"use strict";n.d(t,{R:()=>l});var s=n(72791),a=n(89704),c=n.n(a);const i={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_ARCHIEVED:"http://api1.chandrakala.co.in/api/Tickets/ArchivedByUser",REACT_APP_API_CHANGE_PASSWORD:"http://api1.chandrakala.co.in/api/Login/ChangePassword",REACT_APP_API_DEPARTMENTS:"http://api1.chandrakala.co.in/api/Departments",REACT_APP_API_FORGOT_PASSWORD:"http://api1.chandrakala.co.in/api/Login/ForgetPassword",REACT_APP_API_LOGIN:"http://api1.chandrakala.co.in/api/Login",REACT_APP_API_MODULE:"http://api1.chandrakala.co.in/api/Module",REACT_APP_API_PERMISSION:"http://api1.chandrakala.co.in/api/Permission",REACT_APP_API_PROJECTTYPE:"http://api1.chandrakala.co.in/api/ProjectType",REACT_APP_API_ROLES:"http://api1.chandrakala.co.in/api/Roles",REACT_APP_API_TICKET:"http://api1.chandrakala.co.in/api/Tickets",REACT_APP_API_TICKETFLOW:"http://api1.chandrakala.co.in/api/TicketFlow",REACT_APP_API_TICKETFLOW_BY_COMMENTS:"http://api1.chandrakala.co.in/api/TicketFlow/CommentsByTicketId",REACT_APP_API_TICKETTYPE:"http://api1.chandrakala.co.in/api/TicketTypes",REACT_APP_API_TICKET_COMPLETED:"http://api1.chandrakala.co.in/api/Tickets/MarkCompleted",REACT_APP_API_UPLOAD:"http://api1.chandrakala.co.in/api/Users/upload",REACT_APP_API_USERS:"http://api1.chandrakala.co.in/api/Users",REACT_APP_API_USER_BY_ID:"http://api1.chandrakala.co.in/api/Users",REACT_APP_BASE_API_URL:"http://api1.chandrakala.co.in/api",REACT_APP_BASE_URL:"http://api1.chandrakala.co.in",REACT_APP_MY_SERVER:"http://test1.chandrakala.co.in"}.REACT_APP_SECRET_KEY||"ghjsfysdg123",r=(0,s.createContext)({encrypt:e=>{console.log("Data to encrypt:",e);const t=c().AES.encrypt(e.toString(),i).toString();return console.log("Encrypted data:",t),t.replace(/\//g,";")},decrypt:e=>{if("string"!==typeof e)return e;e=e.replace(/;/g,"/");return c().AES.decrypt(e,i).toString(c().enc.Utf8)}}),l=()=>(0,s.useContext)(r)},29958:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>p});var s=n(72791),a=n(30734),c=n(45471),i=n(55087),r=n(6265),l=n(58990),o=(n(91128),n(583)),d=n(80184);const h="http://api1.chandrakala.co.in/api/Tickets",p=()=>{const{user:e}=(0,o.a)(),[t,n]=(0,s.useState)({open:0,pending:0,selfassigned:0,completed:0}),[p,u]=(0,s.useState)([]),[x,j]=(0,s.useState)(!0);return(0,s.useEffect)((()=>{(async()=>{try{const t=await fetch("".concat(h,"/status-count?email=").concat(e.email)),s=await t.json();n({open:s.openCount,pending:s.pendingCount,selfassigned:s.selfassignedCount,completed:s.completedCount});const a=await fetch("".concat(h,"/ByUser?email=").concat(e.email)),c=await a.json();u(c),j(!1)}catch(t){console.error("Error fetching data:",t)}finally{j(!1)}})()}),[e]),(0,d.jsx)(a.r,{children:(0,d.jsx)(c.b,{xs:12,className:"d-flex align-items-center justify-content-center",children:(0,d.jsx)(i.x,{className:"mb-4 ",style:{height:"370px"},children:(0,d.jsx)(r.s,{children:(0,d.jsx)(l.fH,{data:{labels:["Open","Pending","Self-Assigned","Completed"],datasets:[{data:[t.open,t.pending,t.selfassigned,t.completed],backgroundColor:["#08683A","#36A2EB","#FFFF33","#F77000"],hoverBackgroundColor:["#08683A","#36A2EB","#FFFF33","#F77000"]}]}})})})})})}},48692:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>S});var s=n(72791),a=n(47022),c=n(89743),i=n(2677),r=n(43360),l=n(24849),o=n(62591),d=n(47798),h=n(12576),p=n(17612),u=n(88890),x=n.n(u),j=n(11087),m=n(9806),f=n(11632),g=n(55294),_=n(24220),v=n(80184);const A="http://api1.chandrakala.co.in",P=e=>{let{tickets:t,setTickets:n}=e;const{encrypt:a}=(0,_.R)(),[c,i]=(0,s.useState)(!1),[l,u]=(0,s.useState)(null),[P,E]=(0,s.useState)({}),[T,k]=(0,s.useState)(!1),[C,y]=(0,s.useState)(!1),[S,w]=(0,s.useState)(!1),N=(0,s.useRef)(null);(0,s.useEffect)((()=>{N.current&&x()(N.current).DataTable();t.forEach((e=>{(async e=>{try{const t=await fetch("".concat("http://api1.chandrakala.co.in/api/TicketFlow/CommentsByTicketId","/").concat(e));if(!t.ok)throw new Error("HTTP error! Status: ".concat(t.status));const n=await t.json(),s=n.length>0?n[n.length-1].comment:"No comments";E((t=>({...t,[e]:s})))}catch(t){console.error("Error fetching comments for ticket ".concat(e,":"),t)}})(e.ticketId)}))}),[t]);const I=()=>{u(null),k(!1)},R=()=>{console.log("Archiving ticket:",l),g.Z.put("".concat("http://api1.chandrakala.co.in/api/Tickets","/").concat(l.ticketId,"/archive")).then((e=>{console.log("Ticket archived successfully:",e.data),n(t.filter((e=>e.ticketId!==l.ticketId)))})).catch((e=>{console.error("Error archiving ticket:",e)})),I()};return(0,v.jsxs)("div",{className:"mt-6 table-responsive",children:[(0,v.jsxs)(o.Z,{striped:!0,bordered:!0,hover:!0,ref:N,className:"table-primary",children:[(0,v.jsx)("thead",{children:(0,v.jsxs)("tr",{children:[(0,v.jsx)("th",{children:"S.No"}),(0,v.jsx)("th",{children:"Title"}),(0,v.jsx)("th",{children:"Status"}),(0,v.jsx)("th",{children:"Priority"}),(0,v.jsx)("th",{children:"DueDate"}),(0,v.jsx)("th",{children:"Creator Email"}),(0,v.jsx)("th",{children:"Actions"})]})}),(0,v.jsx)("tbody",{children:t.map(((e,t)=>(0,v.jsxs)("tr",{children:[(0,v.jsx)("td",{children:t+1}),(0,v.jsx)("td",{children:(0,v.jsx)(d.Z,{placement:"top",delay:{show:250,hide:400},overlay:(0,v.jsx)(h.Z,{id:"tooltip-".concat(e.ticketId),children:P[e.ticketId]?(0,v.jsxs)(v.Fragment,{children:["Last comment:",(0,v.jsx)("div",{dangerouslySetInnerHTML:{__html:P[e.ticketId]}})]}):(0,v.jsxs)("div",{children:["Description: ",(0,v.jsx)("br",{}),e.description]})}),children:(0,v.jsx)("span",{children:e.title})},e.ticketId)}),(0,v.jsx)("td",{children:e.status}),(0,v.jsx)("td",{children:e.priority}),(0,v.jsx)("td",{children:new Date(e.dueDate).toLocaleString()}),(0,v.jsx)("td",{children:e.email}),(0,v.jsx)("td",{children:(0,v.jsxs)("div",{className:"d-flex gap-3 align-items-center",children:[(0,v.jsx)(j.rU,{to:"/Tickets/EditTicket/".concat(a(e.ticketId)),children:(0,v.jsx)(m.G,{icon:f.e0A,className:"text-primary"})}),(0,v.jsx)(r.Z,{variant:"link",onClick:()=>(e=>{u(e),i(!0)})(e),children:(0,v.jsx)(m.G,{icon:f.Mdf,className:"text-success"})}),(0,v.jsx)(m.G,{icon:f.On6,className:"text-danger",onClick:()=>(e=>{u(e),k(!0)})(e)}),(0,v.jsxs)(p.Z,{show:T,onHide:I,children:[(0,v.jsx)(p.Z.Header,{closeButton:!0,children:(0,v.jsx)(p.Z.Title,{children:"Confirm Archive"})}),(0,v.jsxs)(p.Z.Body,{children:["Are you sure you want to archive ticket ",l?l.id:"","?"]}),(0,v.jsxs)(p.Z.Footer,{children:[(0,v.jsx)(r.Z,{variant:"secondary",onClick:I,children:"Cancel"}),(0,v.jsx)(r.Z,{variant:"danger",onClick:R,children:"Archive"})]})]})]})})]},e.ticketId)))})]}),l&&(0,v.jsxs)(p.Z,{show:c,onHide:()=>i(!1),size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[(0,v.jsx)(p.Z.Header,{closeButton:!0,children:(0,v.jsx)(p.Z.Title,{id:"contained-modal-title-vcenter",children:"Ticket Details"})}),(0,v.jsxs)(p.Z.Body,{children:[(0,v.jsxs)("p",{children:["Title: ",l.title]}),(0,v.jsxs)("p",{children:["Description: ",l.description]}),(0,v.jsxs)("p",{children:["Creator ID: ",l.email]}),(0,v.jsxs)("p",{children:["Assignee ID: ",l.assigneeEmail]}),(0,v.jsx)("p",{children:"Attachments:"}),l.attachment&&(0,v.jsx)("div",{children:S&&/\.(png|jpg|jpeg|gif|bmp)$/i.test(l.attachment)?(0,v.jsx)("img",{src:"".concat(A,"/").concat(l.attachment.replace("wwwroot/","")),alt:"Attachment",className:"img-fluid"}):(0,v.jsx)("p",{children:(0,v.jsx)("a",{href:"".concat(A,"/").concat(l.attachment.replace("wwwroot/","")),target:"_blank",rel:"noopener noreferrer",children:"View Attachment"})})})]}),(0,v.jsx)(p.Z.Footer,{children:(0,v.jsx)(r.Z,{onClick:()=>i(!1),children:"Close"})})]})]})};var E=n(583),T=n(29958);const k=()=>{const[e,t]=(0,s.useState)([]),[n,a]=(0,s.useState)(!1),{user:c,isLoading:i,isError:r}=(0,E.a)();(0,s.useEffect)((()=>{i||r||l()}),[i,r,c.email]);const l=async()=>{a(!0);try{const e=(await g.Z.get("".concat("http://api1.chandrakala.co.in","/api/Tickets?includeArchived=false"))).data.filter((e=>e.assigneeEmail===c.email));t(e)}catch(e){console.error("Error fetching tickets:",e)}finally{a(!1)}};if(i)return(0,v.jsx)("div",{children:"Loading..."});if(r)return(0,v.jsx)("div",{children:"Error fetching user data."});const d=(()=>{const t=(new Date).toISOString().split("T")[0];return e.filter((e=>e.dueDate.split("T")[0]===t))})(),h=(()=>{const t=new Date,n=new Date;return n.setDate(t.getDate()+2),e.filter((e=>{const s=new Date(e.dueDate);return s>t&&s<=n}))})();return(0,v.jsxs)("div",{children:[0===d.length&&(0,v.jsxs)("div",{children:[(0,v.jsx)("div",{children:"No tasks due today."}),(0,v.jsxs)("div",{children:[(0,v.jsx)("h5",{children:"Upcoming Tasks"}),(0,v.jsxs)(o.Z,{striped:!0,bordered:!0,hover:!0,children:[(0,v.jsx)("thead",{children:(0,v.jsxs)("tr",{children:[(0,v.jsx)("th",{children:"S.No"}),(0,v.jsx)("th",{children:"Title"}),(0,v.jsx)("th",{children:"Deadline"})]})}),(0,v.jsx)("tbody",{children:h.map(((e,t)=>(0,v.jsxs)("tr",{children:[(0,v.jsx)("td",{children:t+1}),(0,v.jsx)("td",{children:e.title}),(0,v.jsx)("td",{children:e.dueDate.split("T")[0]})]},e.ticketId)))})]})]})]}),d.length>0&&(0,v.jsxs)(o.Z,{striped:!0,bordered:!0,hover:!0,children:[(0,v.jsx)("thead",{children:(0,v.jsxs)("tr",{children:[(0,v.jsx)("th",{children:"S.No"}),(0,v.jsx)("th",{children:"Title"}),(0,v.jsx)("th",{children:"Deadline"})]})}),(0,v.jsx)("tbody",{children:d.map(((e,t)=>(0,v.jsxs)("tr",{children:[(0,v.jsx)("td",{children:t+1}),(0,v.jsx)("td",{children:e.title}),(0,v.jsx)("td",{children:e.dueDate.split("T")[0]})]},e.ticketId)))})]})]})};var C=n(57689);const y="http://api1.chandrakala.co.in/api/Tickets",S=()=>{const{user:e}=(0,E.a)(),[t,n]=(0,s.useState)({open:0,pending:0,selfassigned:0,completed:0}),[o,d]=(0,s.useState)([]),[h,p]=(0,s.useState)(!0),[u,x]=(0,s.useState)(!1);(0,C.s0)();(0,s.useEffect)((()=>{(async()=>{try{const t=await fetch("".concat(y,"/status-count?email=").concat(e.email)),s=await t.json();n({open:s.openCount,pending:s.pendingCount,selfassigned:s.selfassignedCount,completed:s.completedCount});const a=await fetch("".concat(y,"/ByUser?email=").concat(e.email)),c=await a.json();d(c),p(!1)}catch(t){console.error("Error fetching data:",t)}finally{p(!1)}})()}),[e]);return(0,v.jsxs)("div",{children:[(0,v.jsx)(a.Z,{children:(0,v.jsxs)(c.Z,{className:"row-cols-1 row-cols-md-2",children:[(0,v.jsxs)(i.Z,{md:6,children:[(0,v.jsxs)(c.Z,{className:"mb-3",children:[(0,v.jsx)(i.Z,{children:(0,v.jsxs)("div",{className:"card-client",children:[(0,v.jsx)("div",{className:"user-picture",children:(0,v.jsx)("p",{className:"number",children:t.open})}),(0,v.jsx)("p",{className:"name-client",children:"Open"})]})}),(0,v.jsx)(i.Z,{children:(0,v.jsxs)("div",{className:"card-client",children:[(0,v.jsxs)("div",{className:"user-picture",children:[(0,v.jsx)("svg",{viewBox:"0 0 448 512",xmlns:"http://www.w3.org/2000/svg"}),(0,v.jsx)("p",{className:"number",children:t.pending})]}),(0,v.jsx)("p",{className:"name-client",children:"Pending"})]})})]}),(0,v.jsxs)(c.Z,{children:[(0,v.jsx)(i.Z,{children:(0,v.jsxs)("div",{className:"card-client",children:[(0,v.jsxs)("div",{className:"user-picture",children:[(0,v.jsx)("svg",{viewBox:"0 0 448 512",xmlns:"http://www.w3.org/2000/svg"}),(0,v.jsx)("p",{className:"number",children:t.selfassigned})]}),(0,v.jsx)("p",{className:"name-client",children:"Self Assigned"})]})}),(0,v.jsx)(i.Z,{children:(0,v.jsxs)("div",{className:"card-client",children:[(0,v.jsxs)("div",{className:"user-picture",children:[(0,v.jsx)("svg",{viewBox:"0 0 448 512",xmlns:"http://www.w3.org/2000/svg"}),(0,v.jsx)("p",{className:"number",children:t.completed})]}),(0,v.jsx)("p",{className:"name-client",children:"Completed"})]})})]})]}),(0,v.jsx)(i.Z,{md:4,children:(0,v.jsx)(T.default,{})}),(0,v.jsxs)(i.Z,{md:2,children:[(0,v.jsx)(c.Z,{children:(0,v.jsx)(i.Z,{children:(0,v.jsx)(r.Z,{onClick:()=>{x(!u)},variant:"danger",children:"Due Today"})})}),(0,v.jsx)(c.Z,{children:(0,v.jsx)(i.Z,{children:u&&(0,v.jsx)(k,{})})})]})]})}),h?(0,v.jsx)("div",{className:"text-center",children:(0,v.jsx)(l.Z,{animation:"border",role:"status",children:(0,v.jsx)("span",{className:"visually-hidden",children:"loading.."})})}):(0,v.jsx)(P,{tickets:o,setTickets:d})]})}},92176:e=>{"use strict";e.exports=function(e,t,n,s,a,c,i,r){if(!e){var l;if(void 0===t)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var o=[n,s,a,c,i,r],d=0;(l=new Error(t.replace(/%s/g,(function(){return o[d++]})))).name="Invariant Violation"}throw l.framesToPop=1,l}}},2677:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var s=n(81694),a=n.n(s),c=n(72791),i=n(10162),r=n(80184);const l=c.forwardRef(((e,t)=>{const[{className:n,...s},{as:c="div",bsPrefix:l,spans:o}]=function(e){let{as:t,bsPrefix:n,className:s,...c}=e;n=(0,i.vE)(n,"col");const r=(0,i.pi)(),l=(0,i.zG)(),o=[],d=[];return r.forEach((e=>{const t=c[e];let s,a,i;delete c[e],"object"===typeof t&&null!=t?({span:s,offset:a,order:i}=t):s=t;const r=e!==l?"-".concat(e):"";s&&o.push(!0===s?"".concat(n).concat(r):"".concat(n).concat(r,"-").concat(s)),null!=i&&d.push("order".concat(r,"-").concat(i)),null!=a&&d.push("offset".concat(r,"-").concat(a))})),[{...c,className:a()(s,...o,...d)},{as:t,bsPrefix:n,spans:o}]}(e);return(0,r.jsx)(c,{...s,ref:t,className:a()(n,!o.length&&l)})}));l.displayName="Col";const o=l},47022:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var s=n(81694),a=n.n(s),c=n(72791),i=n(10162),r=n(80184);const l=c.forwardRef(((e,t)=>{let{bsPrefix:n,fluid:s=!1,as:c="div",className:l,...o}=e;const d=(0,i.vE)(n,"container"),h="string"===typeof s?"-".concat(s):"-fluid";return(0,r.jsx)(c,{ref:t,...o,className:a()(l,s?"".concat(d).concat(h):d)})}));l.displayName="Container";const o=l},89743:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var s=n(81694),a=n.n(s),c=n(72791),i=n(10162),r=n(80184);const l=c.forwardRef(((e,t)=>{let{bsPrefix:n,className:s,as:c="div",...l}=e;const o=(0,i.vE)(n,"row"),d=(0,i.pi)(),h=(0,i.zG)(),p="".concat(o,"-cols"),u=[];return d.forEach((e=>{const t=l[e];let n;delete l[e],null!=t&&"object"===typeof t?({cols:n}=t):n=t;const s=e!==h?"-".concat(e):"";null!=n&&u.push("".concat(p).concat(s,"-").concat(n))})),(0,r.jsx)(c,{ref:t,...l,className:a()(s,o,...u)})}));l.displayName="Row";const o=l},80239:(e,t,n)=>{"use strict";n.d(t,{Ch:()=>o,$c:()=>l});var s=n(87462),a=n(63366),c=n(72791);n(92176);function i(e){return"default"+e.charAt(0).toUpperCase()+e.substr(1)}function r(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,t||"default");if("object"!==typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}function l(e,t,n){var s=(0,c.useRef)(void 0!==e),a=(0,c.useState)(t),i=a[0],r=a[1],l=void 0!==e,o=s.current;return s.current=l,!l&&o&&i!==t&&r(t),[l?e:i,(0,c.useCallback)((function(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),a=1;a<t;a++)s[a-1]=arguments[a];n&&n.apply(void 0,[e].concat(s)),r(e)}),[n])]}function o(e,t){return Object.keys(t).reduce((function(n,c){var o,d=n,h=d[i(c)],p=d[c],u=(0,a.Z)(d,[i(c),c].map(r)),x=t[c],j=l(p,h,e[x]),m=j[0],f=j[1];return(0,s.Z)({},u,((o={})[c]=m,o[x]=f,o))}),e)}function d(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);null!==e&&void 0!==e&&this.setState(e)}function h(e){this.setState(function(t){var n=this.constructor.getDerivedStateFromProps(e,t);return null!==n&&void 0!==n?n:null}.bind(this))}function p(e,t){try{var n=this.props,s=this.state;this.props=e,this.state=t,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(n,s)}finally{this.props=n,this.state=s}}d.__suppressDeprecationWarning=!0,h.__suppressDeprecationWarning=!0,p.__suppressDeprecationWarning=!0},42480:()=>{},87462:(e,t,n)=>{"use strict";function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},s.apply(this,arguments)}n.d(t,{Z:()=>s})}}]);
//# sourceMappingURL=9561.76e741bb.chunk.js.map